import{j as e}from"./query-PEscxNU0.js";import{r as h,k as H}from"./vendor-rrO37E5y.js";import{C as v,a as g,b,d as p}from"./card-CFab1DRg.js";import{k as O,b as Y,P as k,d as X,R as q,I as J,e as y,l as P,i as Q,f as U,a as C,m as Z}from"./index-BREQ0THK.js";import{S as T}from"./skeleton-CUc6RUg3.js";import{g as ee,b as x,h as te,i as S}from"./useDashboardData-DutdldH1.js";import{R as ae,A as re,b as R,X as A,Y as I,T as _,d as se,L as ne,e as ie}from"./charts-DxkWeNkm.js";import{T as oe,a as le,b as D,c as j,d as de,e as N}from"./table-SEQfNtEc.js";import"./firebase-Cbh-IGzk.js";var w="Tabs",[ce]=Q(w,[P]),z=P(),[ue,E]=ce(w),L=h.forwardRef((a,r)=>{const{__scopeTabs:i,value:t,onValueChange:o,defaultValue:c,orientation:s="horizontal",dir:u,activationMode:m="automatic",...n}=a,l=O(u),[d,f]=Y({prop:t,onChange:o,defaultProp:c??"",caller:w});return e.jsx(ue,{scope:i,baseId:X(),value:d,onValueChange:f,orientation:s,dir:l,activationMode:m,children:e.jsx(k.div,{dir:l,"data-orientation":s,...n,ref:r})})});L.displayName=w;var V="TabsList",M=h.forwardRef((a,r)=>{const{__scopeTabs:i,loop:t=!0,...o}=a,c=E(V,i),s=z(i);return e.jsx(q,{asChild:!0,...s,orientation:c.orientation,dir:c.dir,loop:t,children:e.jsx(k.div,{role:"tablist","aria-orientation":c.orientation,...o,ref:r})})});M.displayName=V;var W="TabsTrigger",$=h.forwardRef((a,r)=>{const{__scopeTabs:i,value:t,disabled:o=!1,...c}=a,s=E(W,i),u=z(i),m=K(s.baseId,t),n=B(s.baseId,t),l=t===s.value;return e.jsx(J,{asChild:!0,...u,focusable:!o,active:l,children:e.jsx(k.button,{type:"button",role:"tab","aria-selected":l,"aria-controls":n,"data-state":l?"active":"inactive","data-disabled":o?"":void 0,disabled:o,id:m,...c,ref:r,onMouseDown:y(a.onMouseDown,d=>{!o&&d.button===0&&d.ctrlKey===!1?s.onValueChange(t):d.preventDefault()}),onKeyDown:y(a.onKeyDown,d=>{[" ","Enter"].includes(d.key)&&s.onValueChange(t)}),onFocus:y(a.onFocus,()=>{const d=s.activationMode!=="manual";!l&&!o&&d&&s.onValueChange(t)})})})});$.displayName=W;var G="TabsContent",me=h.forwardRef((a,r)=>{const{__scopeTabs:i,value:t,forceMount:o,children:c,...s}=a,u=E(G,i),m=K(u.baseId,t),n=B(u.baseId,t),l=t===u.value,d=h.useRef(l);return h.useEffect(()=>{const f=requestAnimationFrame(()=>d.current=!1);return()=>cancelAnimationFrame(f)},[]),e.jsx(U,{present:o||l,children:({present:f})=>e.jsx(k.div,{"data-state":l?"active":"inactive","data-orientation":u.orientation,role:"tabpanel","aria-labelledby":m,hidden:!f,id:n,tabIndex:0,...s,ref:r,style:{...a.style,animationDuration:d.current?"0s":void 0},children:f&&c})})});me.displayName=G;function K(a,r){return`${a}-trigger-${r}`}function B(a,r){return`${a}-content-${r}`}var xe=L,he=M,fe=$;function ve({className:a,orientation:r="horizontal",...i}){return e.jsx(xe,{"data-slot":"tabs","data-orientation":r,orientation:r,className:C("group/tabs flex gap-2 data-[orientation=horizontal]:flex-col",a),...i})}const ge=Z("rounded-lg p-[3px] group-data-[orientation=horizontal]/tabs:h-9 data-[variant=line]:rounded-none group/tabs-list text-muted-foreground inline-flex w-fit items-center justify-center group-data-[orientation=vertical]/tabs:h-fit group-data-[orientation=vertical]/tabs:flex-col",{variants:{variant:{default:"bg-muted",line:"gap-1 bg-transparent"}},defaultVariants:{variant:"default"}});function be({className:a,variant:r="default",...i}){return e.jsx(he,{"data-slot":"tabs-list","data-variant":r,className:C(ge({variant:r}),a),...i})}function F({className:a,...r}){return e.jsx(fe,{"data-slot":"tabs-trigger",className:C("focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:outline-ring text-foreground/60 hover:text-foreground dark:text-muted-foreground dark:hover:text-foreground relative inline-flex h-[calc(100%-1px)] flex-1 items-center justify-center gap-1.5 rounded-md border border-transparent px-2 py-1 text-sm font-medium whitespace-nowrap transition-all group-data-[orientation=vertical]/tabs:w-full group-data-[orientation=vertical]/tabs:justify-start focus-visible:ring-[3px] focus-visible:outline-1 disabled:pointer-events-none disabled:opacity-50 group-data-[variant=default]/tabs-list:data-[state=active]:shadow-sm group-data-[variant=line]/tabs-list:data-[state=active]:shadow-none [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4","group-data-[variant=line]/tabs-list:bg-transparent group-data-[variant=line]/tabs-list:data-[state=active]:bg-transparent dark:group-data-[variant=line]/tabs-list:data-[state=active]:border-transparent dark:group-data-[variant=line]/tabs-list:data-[state=active]:bg-transparent","data-[state=active]:bg-background dark:data-[state=active]:text-foreground dark:data-[state=active]:border-input dark:data-[state=active]:bg-input/30 data-[state=active]:text-foreground","after:bg-foreground after:absolute after:opacity-0 after:transition-opacity group-data-[orientation=horizontal]/tabs:after:inset-x-0 group-data-[orientation=horizontal]/tabs:after:bottom-[-5px] group-data-[orientation=horizontal]/tabs:after:h-0.5 group-data-[orientation=vertical]/tabs:after:inset-y-0 group-data-[orientation=vertical]/tabs:after:-right-1 group-data-[orientation=vertical]/tabs:after:w-0.5 group-data-[variant=line]/tabs-list:data-[state=active]:after:opacity-100",a),...r})}function pe({timeline:a,showCumulative:r=!0}){const i=a.map(t=>({week:`W${t.weekNumber}`,date:ee(t.weekStart),new:t.newEnrollments,cumulative:t.cumulativeEnrollment}));return e.jsxs(v,{children:[e.jsx(g,{children:e.jsx(b,{children:"Enrollment Timeline"})}),e.jsx(p,{children:e.jsx("div",{className:"h-[300px]",children:e.jsx(ae,{width:"100%",height:"100%",children:r?e.jsxs(re,{data:i,children:[e.jsx(R,{strokeDasharray:"3 3",className:"stroke-muted"}),e.jsx(A,{dataKey:"date",tick:{fill:"var(--muted-foreground)",fontSize:12}}),e.jsx(I,{tick:{fill:"var(--muted-foreground)"},tickFormatter:t=>x(t)}),e.jsx(_,{contentStyle:{backgroundColor:"var(--background)",border:"1px solid var(--border)",borderRadius:"8px"},formatter:(t,o)=>[x(t),o==="cumulative"?"Total Enrolled":"New This Week"]}),e.jsx(se,{type:"monotone",dataKey:"cumulative",stroke:"var(--chart-1)",fill:"var(--chart-1)",fillOpacity:.2})]}):e.jsxs(ne,{data:i,children:[e.jsx(R,{strokeDasharray:"3 3",className:"stroke-muted"}),e.jsx(A,{dataKey:"date",tick:{fill:"var(--muted-foreground)",fontSize:12}}),e.jsx(I,{tick:{fill:"var(--muted-foreground)"},tickFormatter:t=>x(t)}),e.jsx(_,{contentStyle:{backgroundColor:"var(--background)",border:"1px solid var(--border)",borderRadius:"8px"},formatter:t=>[x(t),"New Enrollments"]}),e.jsx(ie,{type:"monotone",dataKey:"new",stroke:"var(--chart-2)",strokeWidth:2,dot:{fill:"var(--chart-2)"}})]})})})})]})}function Ae(){const{selectedYear:a}=H(),{data:r,isLoading:i,error:t}=te(a),[o,c]=h.useState("cumulative");if(i)return e.jsx(je,{});if(t||!r?.timeline||r.timeline.length===0)return e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsxs("p",{className:"text-muted-foreground",children:["No timeline data available for ",a]})});const{timeline:s}=r,u=s.reduce((n,l)=>l.newEnrollments>n.newEnrollments?l:n),m=s.reduce((n,l)=>n+l.newEnrollments,0);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Enrollment Timeline"}),e.jsxs("p",{className:"text-muted-foreground",children:["Track when students enrolled throughout ",a]})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-3",children:[e.jsxs(v,{children:[e.jsx(g,{className:"pb-2",children:e.jsx(b,{className:"text-sm font-medium text-muted-foreground",children:"Final Enrollment"})}),e.jsx(p,{children:e.jsx("p",{className:"text-2xl font-bold",children:x(s[s.length-1]?.cumulativeEnrollment||0)})})]}),e.jsxs(v,{children:[e.jsx(g,{className:"pb-2",children:e.jsx(b,{className:"text-sm font-medium text-muted-foreground",children:"Peak Week"})}),e.jsxs(p,{children:[e.jsxs("p",{className:"text-2xl font-bold",children:["Week ",u.weekNumber]}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[x(u.newEnrollments)," new enrollments"]})]})]}),e.jsxs(v,{children:[e.jsx(g,{className:"pb-2",children:e.jsx(b,{className:"text-sm font-medium text-muted-foreground",children:"Date Range"})}),e.jsxs(p,{children:[e.jsxs("p",{className:"text-2xl font-bold",children:[s.length," weeks"]}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[S(s[0].weekStart)," â€“ ",S(s[s.length-1].weekStart)]})]})]})]}),e.jsxs(v,{children:[e.jsx(g,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(b,{children:"Enrollment Over Time"}),e.jsx(ve,{value:o,onValueChange:n=>c(n),children:e.jsxs(be,{children:[e.jsx(F,{value:"cumulative",children:"Cumulative"}),e.jsx(F,{value:"weekly",children:"Weekly"})]})})]})}),e.jsx(p,{children:e.jsx(pe,{timeline:s,showCumulative:o==="cumulative"})})]}),e.jsxs(v,{children:[e.jsx(g,{children:e.jsx(b,{children:"Weekly Breakdown"})}),e.jsx(p,{children:e.jsxs(oe,{children:[e.jsx(le,{children:e.jsxs(D,{children:[e.jsx(j,{children:"Week"}),e.jsx(j,{children:"Start Date"}),e.jsx(j,{className:"text-right",children:"New Enrollments"}),e.jsx(j,{className:"text-right",children:"Cumulative Total"}),e.jsx(j,{className:"text-right",children:"% of Total"})]})}),e.jsx(de,{children:s.map(n=>e.jsxs(D,{children:[e.jsxs(N,{className:"font-medium",children:["Week ",n.weekNumber]}),e.jsx(N,{children:new Date(n.weekStart).toLocaleDateString()}),e.jsx(N,{className:"text-right",children:x(n.newEnrollments)}),e.jsx(N,{className:"text-right",children:x(n.cumulativeEnrollment)}),e.jsxs(N,{className:"text-right",children:[m>0?(n.newEnrollments/m*100).toFixed(1):0,"%"]})]},n.id))})]})})]})]})}function je(){return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx(T,{className:"h-9 w-64"}),e.jsx(T,{className:"h-5 w-48 mt-2"})]}),e.jsx("div",{className:"grid gap-4 md:grid-cols-3",children:[...Array(3)].map((a,r)=>e.jsx(T,{className:"h-24"},r))}),e.jsx(T,{className:"h-[400px]"})]})}export{Ae as TimelinePage};
