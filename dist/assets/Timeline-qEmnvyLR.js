import{j as e}from"./query-PEscxNU0.js";import{r as h,k as B}from"./vendor-rrO37E5y.js";import{C as v,a as b,b as g,d as p}from"./card-BVP9ISh_.js";import{b as H,d as O,P as k,e as Y,R as X,I as q,f as w,g as F,h as J,i as Q,a as C,j as U}from"./index-BjTlyl9m.js";import{e as Z,b as x,g as ee,S as T}from"./skeleton-D3kqVnK9.js";import{R as te,A as ae,b as S,X as R,Y as A,T as I,e as re,f as se,g as ne}from"./charts-BfQSYQe1.js";import{T as ie,a as oe,b as _,c as j,d as le,e as N}from"./table-BpeqsKHD.js";import"./firebase-CBGyZlqu.js";import"./functions-BHy5G0pi.js";var y="Tabs",[de]=J(y,[F]),P=F(),[ce,E]=de(y),z=h.forwardRef((a,r)=>{const{__scopeTabs:i,value:t,onValueChange:o,defaultValue:c,orientation:s="horizontal",dir:u,activationMode:m="automatic",...n}=a,l=H(u),[d,f]=O({prop:t,onChange:o,defaultProp:c??"",caller:y});return e.jsx(ce,{scope:i,baseId:Y(),value:d,onValueChange:f,orientation:s,dir:l,activationMode:m,children:e.jsx(k.div,{dir:l,"data-orientation":s,...n,ref:r})})});z.displayName=y;var V="TabsList",W=h.forwardRef((a,r)=>{const{__scopeTabs:i,loop:t=!0,...o}=a,c=E(V,i),s=P(i);return e.jsx(X,{asChild:!0,...s,orientation:c.orientation,dir:c.dir,loop:t,children:e.jsx(k.div,{role:"tablist","aria-orientation":c.orientation,...o,ref:r})})});W.displayName=V;var L="TabsTrigger",M=h.forwardRef((a,r)=>{const{__scopeTabs:i,value:t,disabled:o=!1,...c}=a,s=E(L,i),u=P(i),m=G(s.baseId,t),n=K(s.baseId,t),l=t===s.value;return e.jsx(q,{asChild:!0,...u,focusable:!o,active:l,children:e.jsx(k.button,{type:"button",role:"tab","aria-selected":l,"aria-controls":n,"data-state":l?"active":"inactive","data-disabled":o?"":void 0,disabled:o,id:m,...c,ref:r,onMouseDown:w(a.onMouseDown,d=>{!o&&d.button===0&&d.ctrlKey===!1?s.onValueChange(t):d.preventDefault()}),onKeyDown:w(a.onKeyDown,d=>{[" ","Enter"].includes(d.key)&&s.onValueChange(t)}),onFocus:w(a.onFocus,()=>{const d=s.activationMode!=="manual";!l&&!o&&d&&s.onValueChange(t)})})})});M.displayName=L;var $="TabsContent",ue=h.forwardRef((a,r)=>{const{__scopeTabs:i,value:t,forceMount:o,children:c,...s}=a,u=E($,i),m=G(u.baseId,t),n=K(u.baseId,t),l=t===u.value,d=h.useRef(l);return h.useEffect(()=>{const f=requestAnimationFrame(()=>d.current=!1);return()=>cancelAnimationFrame(f)},[]),e.jsx(Q,{present:o||l,children:({present:f})=>e.jsx(k.div,{"data-state":l?"active":"inactive","data-orientation":u.orientation,role:"tabpanel","aria-labelledby":m,hidden:!f,id:n,tabIndex:0,...s,ref:r,style:{...a.style,animationDuration:d.current?"0s":void 0},children:f&&c})})});ue.displayName=$;function G(a,r){return`${a}-trigger-${r}`}function K(a,r){return`${a}-content-${r}`}var me=z,xe=W,he=M;function fe({className:a,orientation:r="horizontal",...i}){return e.jsx(me,{"data-slot":"tabs","data-orientation":r,orientation:r,className:C("group/tabs flex gap-2 data-[orientation=horizontal]:flex-col",a),...i})}const ve=U("rounded-lg p-[3px] group-data-[orientation=horizontal]/tabs:h-9 data-[variant=line]:rounded-none group/tabs-list text-muted-foreground inline-flex w-fit items-center justify-center group-data-[orientation=vertical]/tabs:h-fit group-data-[orientation=vertical]/tabs:flex-col",{variants:{variant:{default:"bg-muted",line:"gap-1 bg-transparent"}},defaultVariants:{variant:"default"}});function be({className:a,variant:r="default",...i}){return e.jsx(xe,{"data-slot":"tabs-list","data-variant":r,className:C(ve({variant:r}),a),...i})}function D({className:a,...r}){return e.jsx(he,{"data-slot":"tabs-trigger",className:C("focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:outline-ring text-foreground/60 hover:text-foreground dark:text-muted-foreground dark:hover:text-foreground relative inline-flex h-[calc(100%-1px)] flex-1 items-center justify-center gap-1.5 rounded-md border border-transparent px-2 py-1 text-sm font-medium whitespace-nowrap transition-all group-data-[orientation=vertical]/tabs:w-full group-data-[orientation=vertical]/tabs:justify-start focus-visible:ring-[3px] focus-visible:outline-1 disabled:pointer-events-none disabled:opacity-50 group-data-[variant=default]/tabs-list:data-[state=active]:shadow-sm group-data-[variant=line]/tabs-list:data-[state=active]:shadow-none [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4","group-data-[variant=line]/tabs-list:bg-transparent group-data-[variant=line]/tabs-list:data-[state=active]:bg-transparent dark:group-data-[variant=line]/tabs-list:data-[state=active]:border-transparent dark:group-data-[variant=line]/tabs-list:data-[state=active]:bg-transparent","data-[state=active]:bg-background dark:data-[state=active]:text-foreground dark:data-[state=active]:border-input dark:data-[state=active]:bg-input/30 data-[state=active]:text-foreground","after:bg-foreground after:absolute after:opacity-0 after:transition-opacity group-data-[orientation=horizontal]/tabs:after:inset-x-0 group-data-[orientation=horizontal]/tabs:after:bottom-[-5px] group-data-[orientation=horizontal]/tabs:after:h-0.5 group-data-[orientation=vertical]/tabs:after:inset-y-0 group-data-[orientation=vertical]/tabs:after:-right-1 group-data-[orientation=vertical]/tabs:after:w-0.5 group-data-[variant=line]/tabs-list:data-[state=active]:after:opacity-100",a),...r})}function ge({timeline:a,showCumulative:r=!0}){const i=a.map(t=>({week:`W${t.weekNumber}`,date:Z(t.weekStart),new:t.newEnrollments,cumulative:t.cumulativeEnrollment}));return e.jsxs(v,{children:[e.jsx(b,{children:e.jsx(g,{children:"Enrollment Timeline"})}),e.jsx(p,{children:e.jsx("div",{className:"h-[300px]",children:e.jsx(te,{width:"100%",height:"100%",children:r?e.jsxs(ae,{data:i,children:[e.jsx(S,{strokeDasharray:"3 3",className:"stroke-muted"}),e.jsx(R,{dataKey:"date",tick:{fill:"hsl(var(--muted-foreground))",fontSize:12}}),e.jsx(A,{tick:{fill:"hsl(var(--muted-foreground))"},tickFormatter:t=>x(t)}),e.jsx(I,{contentStyle:{backgroundColor:"hsl(var(--background))",border:"1px solid hsl(var(--border))",borderRadius:"8px"},formatter:(t,o)=>[x(t),o==="cumulative"?"Total Enrolled":"New This Week"]}),e.jsx(re,{type:"monotone",dataKey:"cumulative",stroke:"hsl(var(--chart-1))",fill:"hsl(var(--chart-1))",fillOpacity:.2})]}):e.jsxs(se,{data:i,children:[e.jsx(S,{strokeDasharray:"3 3",className:"stroke-muted"}),e.jsx(R,{dataKey:"date",tick:{fill:"hsl(var(--muted-foreground))",fontSize:12}}),e.jsx(A,{tick:{fill:"hsl(var(--muted-foreground))"},tickFormatter:t=>x(t)}),e.jsx(I,{contentStyle:{backgroundColor:"hsl(var(--background))",border:"1px solid hsl(var(--border))",borderRadius:"8px"},formatter:t=>[x(t),"New Enrollments"]}),e.jsx(ne,{type:"monotone",dataKey:"new",stroke:"hsl(var(--chart-2))",strokeWidth:2,dot:{fill:"hsl(var(--chart-2))"}})]})})})})]})}function Re(){const{selectedYear:a}=B(),{data:r,isLoading:i,error:t}=ee(a),[o,c]=h.useState("cumulative");if(i)return e.jsx(pe,{});if(t||!r?.timeline||r.timeline.length===0)return e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsxs("p",{className:"text-muted-foreground",children:["No timeline data available for ",a]})});const{timeline:s}=r,u=s.reduce((n,l)=>l.newEnrollments>n.newEnrollments?l:n),m=s.reduce((n,l)=>n+l.newEnrollments,0);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Enrollment Timeline"}),e.jsxs("p",{className:"text-muted-foreground",children:["Track when students enrolled throughout ",a]})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-3",children:[e.jsxs(v,{children:[e.jsx(b,{className:"pb-2",children:e.jsx(g,{className:"text-sm font-medium text-muted-foreground",children:"Final Enrollment"})}),e.jsx(p,{children:e.jsx("p",{className:"text-2xl font-bold",children:x(s[s.length-1]?.cumulativeEnrollment||0)})})]}),e.jsxs(v,{children:[e.jsx(b,{className:"pb-2",children:e.jsx(g,{className:"text-sm font-medium text-muted-foreground",children:"Peak Week"})}),e.jsxs(p,{children:[e.jsxs("p",{className:"text-2xl font-bold",children:["Week ",u.weekNumber]}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[x(u.newEnrollments)," new enrollments"]})]})]}),e.jsxs(v,{children:[e.jsx(b,{className:"pb-2",children:e.jsx(g,{className:"text-sm font-medium text-muted-foreground",children:"Weeks Tracked"})}),e.jsx(p,{children:e.jsx("p",{className:"text-2xl font-bold",children:s.length})})]})]}),e.jsxs(v,{children:[e.jsx(b,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(g,{children:"Enrollment Over Time"}),e.jsx(fe,{value:o,onValueChange:n=>c(n),children:e.jsxs(be,{children:[e.jsx(D,{value:"cumulative",children:"Cumulative"}),e.jsx(D,{value:"weekly",children:"Weekly"})]})})]})}),e.jsx(p,{children:e.jsx(ge,{timeline:s,showCumulative:o==="cumulative"})})]}),e.jsxs(v,{children:[e.jsx(b,{children:e.jsx(g,{children:"Weekly Breakdown"})}),e.jsx(p,{children:e.jsxs(ie,{children:[e.jsx(oe,{children:e.jsxs(_,{children:[e.jsx(j,{children:"Week"}),e.jsx(j,{children:"Start Date"}),e.jsx(j,{className:"text-right",children:"New Enrollments"}),e.jsx(j,{className:"text-right",children:"Cumulative Total"}),e.jsx(j,{className:"text-right",children:"% of Total"})]})}),e.jsx(le,{children:s.map(n=>e.jsxs(_,{children:[e.jsxs(N,{className:"font-medium",children:["Week ",n.weekNumber]}),e.jsx(N,{children:new Date(n.weekStart).toLocaleDateString()}),e.jsx(N,{className:"text-right",children:x(n.newEnrollments)}),e.jsx(N,{className:"text-right",children:x(n.cumulativeEnrollment)}),e.jsxs(N,{className:"text-right",children:[m>0?(n.newEnrollments/m*100).toFixed(1):0,"%"]})]},n.id))})]})})]})]})}function pe(){return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx(T,{className:"h-9 w-64"}),e.jsx(T,{className:"h-5 w-48 mt-2"})]}),e.jsx("div",{className:"grid gap-4 md:grid-cols-3",children:[...Array(3)].map((a,r)=>e.jsx(T,{className:"h-24"},r))}),e.jsx(T,{className:"h-[400px]"})]})}export{Re as TimelinePage};
